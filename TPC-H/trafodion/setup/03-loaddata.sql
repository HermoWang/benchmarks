SET TIMING ON;
SET SCHEMA TPCH;

LOAD INTO TPCH.LINEITEM SELECT
  L_ORDERKEY,
  L_PARTKEY,
  L_SUPPKEY,
  L_LINENUMBER,
  cast(L_QUANTITY AS DECIMAL(15, 2)),
  cast(L_EXTENDEDPRICE AS DECIMAL(15, 2)),
  cast(L_DISCOUNT AS DECIMAL(15, 2)),
  cast(L_TAX AS DECIMAL(15, 2)),
  L_RETURNFLAG,
  L_LINESTATUS,
  cast(L_SHIPDATE AS DATE),
  cast(L_COMMITDATE AS DATE),
  cast(L_RECEIPTDATE AS DATE),
  L_SHIPINSTRUCT,
  L_SHIPMODE,
  L_COMMENT
FROM hive.hive.lineitem;

LOAD INTO TPCH.ORDERS SELECT
  O_ORDERKEY,
  O_CUSTKEY,
  O_ORDERSTATUS,
  cast(O_TOTALPRICE AS DECIMAL(15,2)),
  cast(O_ORDERDATE AS DATE),
  O_ORDERPRIORITY,
  O_CLERK,
  O_SHIPPRIORITY,
  O_COMMENT
FROM hive.hive.orders;

LOAD INTO TPCH.CUSTOMER SELECT
  C_CUSTKEY,
  C_NAME,
  C_ADDRESS,
  C_NATIONKEY,
  C_PHONE,
  cast(C_ACCTBAL AS DECIMAL(15, 2)),
  C_MKTSEGMENT,
  C_COMMENT
FROM hive.hive.customer;

LOAD INTO TPCH.PARTSUPP SELECT
  PS_PARTKEY,
  PS_SUPPKEY,
  PS_AVAILQTY,
  cast(PS_SUPPLYCOST AS DECIMAL(15, 2)),
  PS_COMMENT
FROM hive.hive.partsupp;

LOAD INTO TPCH.SUPPLIER SELECT
  S_SUPPKEY,
  S_NAME,
  S_ADDRESS,
  S_NATIONKEY,
  S_PHONE,
  cast(S_ACCTBAL AS DECIMAL(15, 2)),
  S_COMMENT
FROM hive.hive.supplier;

LOAD INTO TPCH.PART SELECT
  P_PARTKEY,
  P_NAME,
  P_MFGR,
  P_BRAND,
  P_TYPE,
  P_SIZE,
  P_CONTAINER,
  cast(P_RETAILPRICE AS DECIMAL(15, 2)),
  P_COMMENT
FROM hive.hive.part;

LOAD INTO TPCH.REGION SELECT
  R_REGIONKEY,
  R_NAME,
  R_COMMENT
FROM hive.hive.region;

LOAD INTO TPCH.NATION SELECT
  N_NATIONKEY,
  N_NAME,
  N_REGIONKEY,
  N_COMMENT
FROM hive.hive.nation;
