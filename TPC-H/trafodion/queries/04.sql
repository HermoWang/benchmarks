SELECT
  O_ORDERPRIORITY,
  COUNT(*) AS ORDER_COUNT
FROM
  TPCH.ORDERS
WHERE
  O_ORDERDATE >= TO_DATE('1993-07-01')
  AND O_ORDERDATE < TO_DATE('1993-10-01')
  AND EXISTS( SELECT * FROM TPCH.LINEITEM WHERE L_ORDERKEY = O_ORDERKEY AND L_COMMITDATE < L_RECEIPTDATE )
GROUP BY
  O_ORDERPRIORITY
ORDER BY
  O_ORDERPRIORITY
;
