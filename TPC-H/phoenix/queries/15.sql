CREATE VIEW REVENUE0 (SUPPLIER_NO INTEGER, TOTAL_REVENUE DECIMAL(15,2)) AS
  SELECT
    L_SUPPKEY,
    SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
  FROM
    TPCH.LINEITEM
  WHERE
    L_SHIPDATE >= TO_DATE('1996-01-01')
    AND L_SHIPDATE < TO_DATE('1996-04-01')
  GROUP BY
    L_SUPPKEY;

SELECT
  S_SUPPKEY,
  S_NAME,
  S_ADDRESS,
  S_PHONE,
  TOTAL_REVENUE
FROM
  TPCH.SUPPLIER,
  REVENUE0
WHERE
  S_SUPPKEY = SUPPLIER_NO
  AND TOTAL_REVENUE = (
    SELECT MAX(TOTAL_REVENUE)
    FROM
      REVENUE0
  )
ORDER BY
  S_SUPPKEY;

DROP VIEW REVENUE0
;
